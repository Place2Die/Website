name: Pull Request on Master

on:
  pull_request:
    branches:
      - master

jobs:
    lint:
        runs-on: ubuntu-latest
        name: ğŸ” Lint
        steps:
            - name: Checkout ğŸ›
              uses: actions/checkout@master

            - name: Setup node env ğŸ—
              uses: actions/setup-node@v3
              with:
                node-version: ${{ matrix.node }}
                check-latest: true

            - name: Upgrade NPM â¬†ï¸
              run: npm install -g npm

            - name: Cache node_modules ğŸ“¦
              uses: actions/cache@v2.1.7
              with:
                path: ~/.npm
                key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
                restore-keys: |
                  ${{ runner.os }}-node-

            - name: Install dependencies ğŸ‘¨ğŸ»â€ğŸ’»
              run: npm ci --prefer-offline --no-audit

            - name: Run lint ğŸš¨
              run: npm run lint
    build:
        runs-on: ubuntu-latest
        name: ğŸ”¨ Build
        env:
          FIREBASE_API_KEY: ${{ secrets.FIREBASE_API_KEY }}
          FIREBASE_PROJECT_ID: ${{ secrets.FIREBASE_PROJECT_ID }}
        steps:
          - name: Checkout ğŸ›
            uses: actions/checkout@master

          - name: Setup node env ğŸ—
            uses: actions/setup-node@v2.5.1
            with:
              node-version: ${{ matrix.node }}
              check-latest: true

          - name: Upgrade NPM â¬†ï¸
            run: npm install -g npm

          - name: Cache node_modules ğŸ“¦
            uses: actions/cache@v2.1.7
            with:
              path: ~/.npm
              key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
              restore-keys: |
                ${{ runner.os }}-node-

          - name: Install dependencies ğŸ‘¨ğŸ»â€ğŸ’»
            run: npm ci --prefer-offline --no-audit

          - name: Build ğŸ‘·â€
            run: npm run build
